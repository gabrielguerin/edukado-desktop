<ul class="nav navbar-nav">
  <li class="nav-item dropdown">
    <a class="nav-link justify-content-end" id="dropdownSearchButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <%= theme_icon_tag "search" %>
    </a>
    <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownSearchButton">
      <li>
        <%= form_tag(posts_path, method: 'get', class: 'form-inline', role: 'search') do %>
          <div class="input-group my-0">
            <%= text_field_tag :search, nil, placeholder: "Rechercher", class: "form-control", id: "searchbox" %>
            <%= submit_tag '', style: "display: none;" %>
          </div>
        <% end %>
      </li>
    </ul>
  </li>
  <li class="nav-item dropdown notifications">
    <a class="nav-link justify-content-end" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <%= theme_icon_tag "cup" %>
    </a>
    <ul class="dropdown-menu  dropdown-menu-right">
      <li class="dropdown-item">
        <div class="card">
          <div class="card-header justify-content-center text-primary">
            <p>Vous avez actuellement <strong><%= current_user.points %></strong> points.</p>
          </div>
          <div class="card-header border-bottom-0 justify-content-center py-0">
            <h6 class="mb-0">Dernier badge gagné</h6>
          </div>
          <% if current_user.badges.present? %>
            <% current_user.badges.last(1).each do |badge| %>
              <%= render partial: 'badges/badge-card', locals: { badge: badge, shadow: 'shadow-none', padding: 'pt-0' } %>
            <% end %>
          <% else %>
            <p>Vous n'avez pas encore gagné de badges</p>
          <% end %>
          <div class="card-footer d-flex justify-content-between">
            <div>
              <%= link_to "Voir mes badges", user_badge_path(current_user), class: "btn btn-secondary text-uppercase" %>
            </div>
            <div>
              <%= link_to "Tous les badges", badges_path, class: "btn btn-primary text-white text-uppercase" %>
            </div>
          </div>
        </li>
      </ul>
    </li>
    <li class="nav-item">
      <a class="nav-link" href='/statics/about'>
        <%= theme_icon_tag "help-alt" %>
      </a>
    </li>
    <li class="nav-item dropdown user-nav">
      <a class="nav-link justify-content-end" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <%= image_tag(user_avatar(current_user), class: 'avatar rounded-circle', style: 'object-fit: cover;', width: '34', height: '34', alt: 'profile picture') %>
      </a>
      <ul class="dropdown-menu dropdown-menu-right" role="menu">
        <li class="dropdown-item text-center">
          <div class="card">
            <div class="card-body">
              <%= link_to image_tag(user_avatar(current_user), class: 'rounded-circle light-shadow p-1 border border-primary', style: 'object-fit: cover;', width: '120', height: '120', alt: 'profile picture'), posts_user_path(current_user) %>
              <p class="mt-1 p0 d-block">
                <%= link_to "#{current_user.first_name} #{current_user.last_name}", posts_user_path(current_user) %>
              </p>
            </div>
            <div class="card-footer d-flex justify-content-between">
              <div>
                <%= link_to "Modifier mon profil", user_path(current_user), method: :get, class: "btn btn-secondary text-uppercase" %>
              </div>
              <div>
                <%= link_to "Se déconnecter", destroy_user_session_path, method: :delete, class: "btn btn-danger text-white text-uppercase" %>
              </div>
            </div>
          </div>
        </li>
      </ul>
    </li>
  </ul>
